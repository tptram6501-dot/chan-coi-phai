<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Súng Cối 60mm</title>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
    <style>
        body { margin: 0; background: #0b0f0a; color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
        
        /* Tiêu đề trên cùng */
        .header {
            position: absolute; top: 0; width: 100%; text-align: center;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent); 
            padding: 20px 0; z-index: 10;
        }
        .header h1 { margin: 0; font-size: 22px; text-transform: uppercase; letter-spacing: 3px; color: #4caf50; }

        /* Cột phím bên TRÁI - Điều hướng cụm */
        .sidebar-left {
            position: absolute; left: 20px; top: 55%; transform: translateY(-50%);
            display: flex; flex-direction: column; gap: 12px; z-index: 10;
        }

        /* Cột phím bên PHẢI - Thuyết minh */
        .sidebar-right {
            position: absolute; right: 20px; top: 55%; transform: translateY(-50%);
            display: flex; flex-direction: column; gap: 12px; z-index: 10;
        }

        .label { font-size: 10px; color: #888; text-align: center; margin-bottom: 5px; letter-spacing: 1px; }

        .btn {
            width: 150px; padding: 14px; cursor: pointer;
            background: rgba(27, 94, 32, 0.7); color: white;
            border: 1px solid #2e7d32; border-radius: 2px;
            font-weight: bold; font-size: 13px; transition: 0.3s;
        }
        .btn:hover { background: #2e7d32; box-shadow: 0 0 15px rgba(76, 175, 80, 0.4); border-color: #4caf50; }
        
        .btn-info { background: rgba(1, 87, 155, 0.7); border-color: #0277bd; }
        .btn-info:hover { background: #0277bd; box-shadow: 0 0 15px rgba(3, 169, 244, 0.4); border-color: #03a9f4; }

        model-viewer { width: 100vw; height: 100vh; background: radial-gradient(#1a1a1a, #000); }

        /* Hộp thoại thuyết minh chữ */
        #text-box {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 50%; max-height: 200px; background: rgba(0, 0, 0, 0.85);
            border-top: 3px solid #0277bd; padding: 20px; border-radius: 5px;
            display: none; overflow-y: auto; z-index: 20; 
            font-size: 15px; line-height: 1.6; white-space: pre-line;
        }
    </style>
</head>
<body>

    <div class="header"><h1>Súng Cối 60mm</h1></div>

    <div class="sidebar-left">
        <div class="label">DANH MỤC CỤM</div>
        <button class="btn" onclick="location.href='pages/TayCam.html'">Cụm Tay Cầm</button>
        <button class="btn" onclick="location.href='pages/CoCauTam.html'">Cơ Cấu Tầm</button>
        <button class="btn" onclick="location.href='pages/CoCauHuong.html'">Cơ Cấu Hướng</button>
    </div>

    <div class="sidebar-right">
        <div class="label">TRỢ GIÚP</div>
        <button class="btn btn-info" onclick="toggleText()">Thuyết Minh Chữ</button>
        <button class="btn btn-info" id="audio-btn" onclick="toggleAudio()">Phát Âm Thanh</button>
    </div>

    <model-viewer 
        src="models/LapGhepTong.glb" 
        camera-controls 
        auto-rotate 
        shadow-intensity="1"
        exposure="1">
    </model-viewer>

    <div id="text-box"></div>

    <audio id="myAudio" src="ThuyetMinhAmThanh.mp3"></audio>

    <script>
        // Hàm đóng/mở thuyết minh chữ
        function toggleText() {
            const box = document.getElementById('text-box');
            if (box.style.display === 'block') {
                box.style.display = 'none';
            } else {
                fetch('ThuyetMinh.txt')
                    .then(res => {
                        if(!res.ok) throw new Error();
                        return res.text();
                    })
                    .then(data => {
                        box.innerText = data;
                        box.style.display = 'block';
                    })
                    .catch(() => {
                        box.innerText = "Lỗi: Không tìm thấy file ThuyetMinh.txt";
                        box.style.display = 'block';
                    });
            }
        }

        // Hàm điều khiển âm thanh
        const audio = document.getElementById('myAudio');
        const audioBtn = document.getElementById('audio-btn');

        function toggleAudio() {
            if (audio.paused) {
                audio.play();
                audioBtn.innerText = "Dừng Âm Thanh";
                audioBtn.style.background = "#c62828"; // Màu đỏ khi đang phát
            } else {
                audio.pause();
                audioBtn.innerText = "Phát Âm Thanh";
                audioBtn.style.background = "rgba(1, 87, 155, 0.7)";
            }
        }
        
        // Tự động reset nút khi nhạc kết thúc
        audio.onended = function() {
            audioBtn.innerText = "Phát Âm Thanh";
            audioBtn.style.background = "rgba(1, 87, 155, 0.7)";
        };
    </script>
</body>
</html>
